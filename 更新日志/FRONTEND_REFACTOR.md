# å‰ç«¯é‡æ„æ–‡æ¡£ ğŸ“±

## ğŸ¨ é‡æ„æ¦‚è¿°

å‰ç«¯å·²å…¨é¢é‡æ„ï¼Œé‡‡ç”¨æ¨¡å—åŒ–æ¶æ„ï¼Œæå‡äº†ä»£ç å¯ç»´æŠ¤æ€§å’Œç”¨æˆ·ä½“éªŒã€‚

---

## ğŸ“ æ–°çš„å‰ç«¯ç»“æ„

```
static/
â”œâ”€â”€ css/                           # CSSæ¨¡å—
â”‚   â”œâ”€â”€ main.css                  # ä¸»CSSå…¥å£ï¼ˆå¯¼å…¥æ‰€æœ‰æ¨¡å—ï¼‰
â”‚   â”œâ”€â”€ variables.css             # CSSå˜é‡å’Œä¸»é¢˜é…ç½®
â”‚   â”œâ”€â”€ base.css                  # åŸºç¡€æ ·å¼å’Œé‡ç½®
â”‚   â”œâ”€â”€ layout.css                # å¸ƒå±€æ ·å¼
â”‚   â”œâ”€â”€ components.css            # ç»„ä»¶æ ·å¼
â”‚   â”œâ”€â”€ animations.css            # åŠ¨ç”»æ•ˆæœ
â”‚   â””â”€â”€ responsive.css            # å“åº”å¼è®¾è®¡
â”‚
â”œâ”€â”€ js/                            # JavaScriptæ¨¡å—
â”‚   â””â”€â”€ common/                   # å…¬å…±æ¨¡å—
â”‚       â”œâ”€â”€ api.js                # APIè¯·æ±‚å°è£…
â”‚       â”œâ”€â”€ utils.js              # å·¥å…·å‡½æ•°åº“
â”‚       â”œâ”€â”€ toast.js              # Toasté€šçŸ¥ç³»ç»Ÿ
â”‚       â””â”€â”€ storage.js            # LocalStorageç®¡ç†
â”‚
â”œâ”€â”€ style.css                      # åŸå§‹CSSï¼ˆä¿ç•™å¤‡ä»½ï¼‰
â”œâ”€â”€ write.js                       # å†™ä½œé¡µé¢JSï¼ˆå¾…é‡æ„ï¼‰
â”œâ”€â”€ config.js                      # é…ç½®é¡µé¢JSï¼ˆå¾…é‡æ„ï¼‰
â””â”€â”€ history.js                     # å†å²é¡µé¢JSï¼ˆå¾…é‡æ„ï¼‰
```

---

## ğŸ¯ CSSæ¨¡å—åŒ–

### 1. **variables.css** - CSSå˜é‡
å®šä¹‰äº†å…¨å±€ä¸»é¢˜å˜é‡ï¼Œæ˜“äºè‡ªå®šä¹‰ï¼š
- ä¸»é¢˜è‰²å½©
- åŠŸèƒ½è‰²ï¼ˆæˆåŠŸã€é”™è¯¯ã€è­¦å‘Šã€ä¿¡æ¯ï¼‰
- ç°åº¦è‰²
- é˜´å½±æ•ˆæœ
- åœ†è§’å°ºå¯¸
- é—´è·ç³»ç»Ÿ
- è¿‡æ¸¡æ•ˆæœ
- Z-indexå±‚çº§

### 2. **base.css** - åŸºç¡€æ ·å¼
- å…¨å±€é‡ç½®
- ä¼˜åŒ–çš„æ»šåŠ¨æ¡æ ·å¼
- é€‰æ‹©æ–‡æœ¬æ ·å¼
- å·¥å…·ç±»ï¼ˆflexã€textã€spacingï¼‰

### 3. **layout.css** - å¸ƒå±€
- å¯¼èˆªæ æ ·å¼ï¼ˆæ”¯æŒæ»šåŠ¨æ•ˆæœï¼‰
- é¡µé¢å®¹å™¨
- ç»“æœåˆ—è¡¨
- å†å²è®°å½•
- è¡¨å•å¸ƒå±€

### 4. **components.css** - ç»„ä»¶
- æŒ‰é’®ï¼ˆå¤šç§çŠ¶æ€å’Œå°ºå¯¸ï¼‰
- è¡¨å•æ§ä»¶
- å¡ç‰‡
- Toasté€šçŸ¥
- è¿›åº¦æ¡
- æ ‡ç­¾
- æ¨¡æ€æ¡†
- åŠ è½½çŠ¶æ€

### 5. **animations.css** - åŠ¨ç”»
- æ·¡å…¥æ·¡å‡º
- æ»‘å…¥æ»‘å‡º
- ç¼©æ”¾æ•ˆæœ
- æ—‹è½¬åŠ è½½
- è„‰å†²æ•ˆæœ
- éª¨æ¶å±
- æ‚¬åœæ•ˆæœ

### 6. **responsive.css** - å“åº”å¼
- å¹³æ¿é€‚é…
- æ‰‹æœºé€‚é…
- è¶…å®½å±ä¼˜åŒ–
- æ‰“å°æ ·å¼
- è§¦æ‘¸è®¾å¤‡ä¼˜åŒ–

---

## âš¡ JavaScriptæ¨¡å—åŒ–

### 1. **api.js** - APIè¯·æ±‚å°è£…

æä¾›ç»Ÿä¸€çš„HTTPè¯·æ±‚æ¥å£ï¼š

```javascript
// GETè¯·æ±‚
const data = await api.get('/endpoint');

// POSTè¯·æ±‚
const result = await api.post('/endpoint', { data });

// å…·ä½“APIæ–¹æ³•
const config = await api.getConfig();
await api.saveConfig(newConfig);
const models = await api.getModels();
```

**ç‰¹æ€§ï¼š**
- ç»Ÿä¸€é”™è¯¯å¤„ç†
- è‡ªåŠ¨JSONåºåˆ—åŒ–
- æ–‡ä»¶ä¸Šä¼ æ”¯æŒ
- æ‰€æœ‰APIæ–¹æ³•éƒ½å·²å°è£…

### 2. **toast.js** - Toasté€šçŸ¥ç³»ç»Ÿ

ç¾è§‚çš„æ¶ˆæ¯æç¤ºï¼š

```javascript
// æˆåŠŸæç¤º
toast.success('æ“ä½œæˆåŠŸï¼');

// é”™è¯¯æç¤º
toast.error('æ“ä½œå¤±è´¥ï¼Œè¯·é‡è¯•');

// è­¦å‘Šæç¤º
toast.warning('è¯·æ³¨æ„...');

// ä¿¡æ¯æç¤º
toast.info('æç¤ºä¿¡æ¯');

// è‡ªå®šä¹‰æŒç»­æ—¶é—´
toast.success('æ¶ˆæ¯', 5000);

// æ¸…é™¤æ‰€æœ‰Toast
toast.clearAll();
```

**ç‰¹æ€§ï¼š**
- 4ç§ç±»å‹ï¼ˆsuccess, error, warning, infoï¼‰
- è‡ªåŠ¨æ¶ˆå¤±
- å¯æ‰‹åŠ¨å…³é—­
- å¹³æ»‘åŠ¨ç”»
- å“åº”å¼è®¾è®¡

### 3. **utils.js** - å·¥å…·å‡½æ•°åº“

ä¸°å¯Œçš„å·¥å…·å‡½æ•°ï¼š

```javascript
// é˜²æŠ–
const debouncedFn = Utils.debounce(fn, 300);

// èŠ‚æµ
const throttledFn = Utils.throttle(fn, 300);

// æ ¼å¼åŒ–æ–‡ä»¶å¤§å°
Utils.formatFileSize(1024); // "1 KB"

// æ ¼å¼åŒ–æ—¥æœŸ
Utils.formatDate(new Date(), 'YYYY-MM-DD');

// ç›¸å¯¹æ—¶é—´
Utils.timeAgo(new Date('2024-01-01')); // "3ä¸ªæœˆå‰"

// å¤åˆ¶åˆ°å‰ªè´´æ¿
await Utils.copyToClipboard('æ–‡æœ¬');

// éªŒè¯URL
Utils.isValidURL('https://example.com');

// ç”ŸæˆID
Utils.generateId(8);

// å»¶è¿Ÿæ‰§è¡Œ
await Utils.sleep(1000);

// æ·±åº¦å…‹éš†
const cloned = Utils.deepClone(obj);

// æ»šåŠ¨åˆ°å…ƒç´ 
Utils.scrollToElement('#target');

// ä¸‹è½½æ–‡ä»¶
Utils.downloadFile(url, 'filename.docx');
```

### 4. **storage.js** - LocalStorageç®¡ç†

ç±»å‹å®‰å…¨çš„æœ¬åœ°å­˜å‚¨ï¼š

```javascript
// è®¾ç½®å€¼
storage.set('key', { data: 'value' });

// è®¾ç½®å€¼ï¼ˆå¸¦è¿‡æœŸæ—¶é—´ï¼‰
storage.set('key', value, 60000); // 60ç§’åè¿‡æœŸ

// è·å–å€¼
const data = storage.get('key', defaultValue);

// åˆ é™¤å€¼
storage.remove('key');

// æ¸…ç©ºæ‰€æœ‰ï¼ˆä»…æ¸…ç©ºå¸¦å‰ç¼€çš„ï¼‰
storage.clear();

// æ£€æŸ¥æ˜¯å¦å­˜åœ¨
storage.has('key');

// æ‰¹é‡æ“ä½œ
storage.setMultiple({ key1: 'value1', key2: 'value2' });
const data = storage.getMultiple(['key1', 'key2']);

// æ›´æ–°å€¼
storage.update('key', oldValue => newValue);
```

**ç‰¹æ€§ï¼š**
- è‡ªåŠ¨JSONåºåˆ—åŒ–/ååºåˆ—åŒ–
- æ”¯æŒè¿‡æœŸæ—¶é—´
- å‰ç¼€éš”ç¦»
- é”™è¯¯å¤„ç†
- æ‰¹é‡æ“ä½œ

---

## ğŸ¨ UXä¼˜åŒ–

### è§†è§‰ä¼˜åŒ–
1. **å¹³æ»‘åŠ¨ç”»**
   - é¡µé¢æ·¡å…¥æ•ˆæœ
   - åˆ—è¡¨é¡¹æ»‘å…¥åŠ¨ç”»
   - æŒ‰é’®æ‚¬åœæ•ˆæœ
   - è¿›åº¦æ¡åŠ¨ç”»

2. **æ›´å¥½çš„åé¦ˆ**
   - Toasté€šçŸ¥ç³»ç»Ÿ
   - åŠ è½½çŠ¶æ€æ˜¾ç¤º
   - é”™è¯¯æç¤ºä¼˜åŒ–
   - æˆåŠŸåé¦ˆ

3. **å“åº”å¼è®¾è®¡**
   - å®Œç¾é€‚é…æ‰‹æœºã€å¹³æ¿ã€æ¡Œé¢
   - è§¦æ‘¸è®¾å¤‡ä¼˜åŒ–
   - æœ€å°è§¦æ‘¸ç›®æ ‡44px

### äº¤äº’ä¼˜åŒ–
1. **æ€§èƒ½ä¼˜åŒ–**
   - é˜²æŠ–èŠ‚æµ
   - è™šæ‹Ÿæ»šåŠ¨ï¼ˆå¦‚éœ€è¦ï¼‰
   - æ‡’åŠ è½½

2. **å¯è®¿é—®æ€§**
   - é”®ç›˜å¯¼èˆªæ”¯æŒ
   - ARIAæ ‡ç­¾
   - è¯­ä¹‰åŒ–HTML
   - å±å¹•é˜…è¯»å™¨å‹å¥½

---

## ğŸ“ ä½¿ç”¨æŒ‡å—

### åœ¨HTMLä¸­ä½¿ç”¨

```html
<!-- layout.html -->
<link rel="stylesheet" href="{{ url_for('static', filename='css/main.css') }}">

<script src="{{ url_for('static', filename='js/common/utils.js') }}"></script>
<script src="{{ url_for('static', filename='js/common/storage.js') }}"></script>
<script src="{{ url_for('static', filename='js/common/toast.js') }}"></script>
<script src="{{ url_for('static', filename='js/common/api.js') }}"></script>
```

### åœ¨JavaScriptä¸­ä½¿ç”¨

```javascript
// ä½¿ç”¨Toast
toast.success('ä¿å­˜æˆåŠŸï¼');

// ä½¿ç”¨API
const config = await api.getConfig();

// ä½¿ç”¨å·¥å…·å‡½æ•°
const formattedDate = Utils.formatDate(new Date());

// ä½¿ç”¨Storage
storage.set('userSettings', { theme: 'dark' });
```

---

## ğŸ“¦ é¡µé¢æ¨¡å—åŒ–

### å†™ä½œé¡µé¢ (write.js â†’ æ¨¡å—åŒ–)

**åŸæ–‡ä»¶**: `static/write.js` (915è¡Œ) â†’ å·²å¤‡ä»½ä¸º `static/write.js.backup`

**æ–°æ¨¡å—ç»“æ„**:
```
static/js/pages/write/
â”œâ”€â”€ state-manager.js          # çŠ¶æ€ç®¡ç†ï¼ˆä¸»é¢˜ã€å›¾ç‰‡ã€ä»»åŠ¡ï¼‰
â”œâ”€â”€ topic-manager.js          # ä¸»é¢˜è¾“å…¥ç®¡ç†
â”œâ”€â”€ task-manager.js           # ä»»åŠ¡æ‰§è¡Œå’Œè½®è¯¢
â”œâ”€â”€ image-modal.js            # å›¾ç‰‡ä¸Šä¼ æ¨¡æ€æ¡†
â””â”€â”€ main.js                   # ä¸»å…¥å£å’Œåè°ƒå™¨
```

**ä¸»è¦æ”¹è¿›**:
- âœ… ä½¿ç”¨ `api.js` æ›¿æ¢æ‰€æœ‰ `fetch` è°ƒç”¨
- âœ… ä½¿ç”¨ `toast.js` æ›¿æ¢æ‰€æœ‰ `alert()`
- âœ… ä½¿ç”¨ `storage.js` ç®¡ç† localStorage
- âœ… ä½¿ç”¨ `Utils.debounce()` ä¼˜åŒ–è¾“å…¥äº‹ä»¶
- âœ… æ·»åŠ åŠ¨ç”»æ•ˆæœ (`slide-in-left`, `fade-out`)
- âœ… åˆ†ç¦»å…³æ³¨ç‚¹ï¼Œæé«˜å¯ç»´æŠ¤æ€§

**ä½¿ç”¨ç¤ºä¾‹**:
```javascript
// çŠ¶æ€ç®¡ç†
writeStateManager.savePageState(topics, enableImage);
writeStateManager.setTopicImage(index, imageData);

// ä¸»é¢˜ç®¡ç†
topicManager.addTopic('æ–‡ç« æ ‡é¢˜');
topicManager.getAllTopics();

// ä»»åŠ¡ç®¡ç†
taskManager.startGeneration(topics, topicImageMap);
```

### é…ç½®é¡µé¢ (config.js â†’ æ¨¡å—åŒ–)

**åŸæ–‡ä»¶**: `static/config.js` (855è¡Œ) â†’ å·²å¤‡ä»½ä¸º `static/config.js.backup`

**æ–°æ¨¡å—ç»“æ„**:
```
static/js/pages/config/
â”œâ”€â”€ config-manager.js              # é…ç½®åŠ è½½å’Œä¿å­˜
â”œâ”€â”€ api-tester.js                  # APIæµ‹è¯•åŠŸèƒ½
â”œâ”€â”€ image-directory-manager.js     # å›¾ç‰‡ç›®å½•ç®¡ç†
â”œâ”€â”€ priority-sorter.js             # æ‹–æ‹½æ’åºä¼˜å…ˆçº§
â””â”€â”€ main.js                        # ä¸»å…¥å£å’Œåè°ƒå™¨
```

**ä¸»è¦æ”¹è¿›**:
- âœ… ç»Ÿä¸€çš„APIæµ‹è¯•æ¥å£
- âœ… ä½¿ç”¨ `toast.js` æä¾›å³æ—¶åé¦ˆ
- âœ… æ¨¡å—åŒ–çš„é…ç½®ç®¡ç†
- âœ… æ‹–æ‹½æ’åºä½¿ç”¨CSSå˜é‡
- âœ… é”™è¯¯å¤„ç†æ›´å‹å¥½

**ä½¿ç”¨ç¤ºä¾‹**:
```javascript
// é…ç½®ç®¡ç†
await configManager.loadConfig();
await configManager.saveConfig(imageDirs, imagePriority);

// APIæµ‹è¯•
apiTester.testUnsplash();
apiTester.testComfyUI();

// å›¾ç‰‡ç›®å½•
imageDirManager.addDirectory('path', ['tags']);
const dirs = imageDirManager.getDirectories();

// ä¼˜å…ˆçº§æ’åº
prioritySorter.getPriority();
await prioritySorter.loadPriority();
```

### å†å²é¡µé¢ (history.js â†’ æ¨¡å—åŒ–)

**åŸæ–‡ä»¶**: `static/history.js` (82è¡Œ) â†’ å·²å¤‡ä»½ä¸º `static/history.js.backup`

**æ–°æ¨¡å—ç»“æ„**:
```
static/js/pages/history/
â”œâ”€â”€ history-manager.js        # å†å²è®°å½•åŠ è½½å’Œæ˜¾ç¤º
â””â”€â”€ main.js                   # ä¸»å…¥å£å’Œäº‹ä»¶ç»‘å®š
```

**ä¸»è¦æ”¹è¿›**:
- âœ… ä½¿ç”¨ `api.js` è·å–å†å²è®°å½•
- âœ… ä½¿ç”¨ `toast.js` æä¾›åé¦ˆ
- âœ… ä½¿ç”¨ `Utils.formatFileSize()` æ ¼å¼åŒ–å¤§å°
- âœ… æ·»åŠ å¤åˆ¶æ–‡ä»¶ååŠŸèƒ½
- âœ… æ·»åŠ åŠ è½½åŠ¨ç”»å’Œç©ºçŠ¶æ€æç¤º
- âœ… æ¸è¿›å¼åˆ—è¡¨åŠ¨ç”»

**ä½¿ç”¨ç¤ºä¾‹**:
```javascript
// å†å²ç®¡ç†
await historyManager.loadHistory();
historyManager.displayHistory(files);
await historyManager.clearHistory();
```

---

## ğŸš€ é‡æ„å®ŒæˆçŠ¶æ€

### å·²å®Œæˆ âœ…
1. âœ… CSSæ¨¡å—åŒ–
2. âœ… JavaScriptå…¬å…±æ¨¡å—
3. âœ… é‡æ„ write.js (915è¡Œ â†’ 5ä¸ªæ¨¡å—)
4. âœ… é‡æ„ config.js (855è¡Œ â†’ 5ä¸ªæ¨¡å—)
5. âœ… é‡æ„ history.js (82è¡Œ â†’ 2ä¸ªæ¨¡å—)
6. âœ… æ›´æ–°æ‰€æœ‰HTMLæ¨¡æ¿
7. âœ… å¤‡ä»½åŸå§‹æ–‡ä»¶

### æœªæ¥å¢å¼º â³
- [ ] åˆ›å»ºå¯å¤ç”¨UIç»„ä»¶åº“
- [ ] æ·»åŠ å•å…ƒæµ‹è¯•
- [ ] æš—è‰²æ¨¡å¼æ”¯æŒ
- [ ] PWAæ”¯æŒ
- [ ] å›½é™…åŒ–ï¼ˆi18nï¼‰
- [ ] æ›´å¤šåŠ¨ç”»æ•ˆæœ
- [ ] æ€§èƒ½ç›‘æ§

---

## ğŸ¨ ä¸»é¢˜è‡ªå®šä¹‰

ä¿®æ”¹ `css/variables.css` ä¸­çš„CSSå˜é‡å³å¯è‡ªå®šä¹‰ä¸»é¢˜ï¼š

```css
:root {
    --primary-color: #667eea;  /* ä¿®æ”¹ä¸»é¢˜è‰² */
    --success-color: #4caf50;  /* ä¿®æ”¹æˆåŠŸè‰² */
    --border-radius: 8px;      /* ä¿®æ”¹åœ†è§’ */
    /* ... æ›´å¤šå˜é‡ */
}
```

---

## ğŸ“Š æ€§èƒ½ä¼˜åŒ–

- ä½¿ç”¨CSSå˜é‡å‡å°‘é‡å¤ä»£ç 
- æ¨¡å—åŒ–åŠ è½½ï¼ŒæŒ‰éœ€å¼•å…¥
- é˜²æŠ–èŠ‚æµä¼˜åŒ–äº‹ä»¶å¤„ç†
- LocalStorageç¼“å­˜å‡å°‘è¯·æ±‚

---

## ğŸ› å·²çŸ¥é—®é¢˜

æ— 

---

## ğŸ“ æŠ€æœ¯æ”¯æŒ

å¦‚æœ‰é—®é¢˜ï¼Œè¯·æŸ¥çœ‹ï¼š
- ä»£ç æ³¨é‡Š
- æ§åˆ¶å°æ—¥å¿—
- æµè§ˆå™¨å¼€å‘å·¥å…·

---

**é‡æ„å®Œæˆæ—¶é—´ï¼š** 2025å¹´
**ç»´æŠ¤è€…ï¼š** Claude
